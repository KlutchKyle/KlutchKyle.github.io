<html>
    <meta content="user-scalable=no"/>
    <meta charset=UTF-8>
    <title>SteamyShower</title>
    <meta name="viewport", content="width=1280" content="initial-scale=1">
<head>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" charset="utf-8" src="options.js"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/vibrant.js"></script>
 </head>

<body id="body" onload="" background="">

    <div id="blur"> </div>   




<script type="text/javascript">
    var siteWidth = 1200;
    var scale = screen.width / siteWidth
    document.querySelector('meta[name="viewport"]').setAttribute('content', 'width='+siteWidth+', initial-scale='+scale+'');  
    document.getElementById("body").style = "-webkit-animation: fadein 0.2s linear 1 normal; -webkit-animation-fill-mode: forwards";
    //document.getElementById('blur').style.backgroundColor = "rgba(" + blurRed + ", " + blurGreen + ", " + blurBlue + ", " + blurOpacity + ")";
    //document.getElementById('blur').style.backdropFilter = "blur(" + blurRadius + ")";
    

    var colorMatch = function () {
            let v = new Vibrant('/var/mobile/Library/SpringBoard/LockBackgroundThumbnail.jpg')
            wallPalette = palette => wallColor = palette;
            v.getPalette().then(function getColor(palette) {
                if (lightColor == true) {
                    var wallColorRGB = this.wallPalette(palette.LightVibrant.getRgb());
                } else {
                    var wallColorRGB = this.wallPalette(palette.DarkVibrant.getRgb());
                }
                let r = parseInt(wallColorRGB[0]);
                let g = parseInt(wallColorRGB[1]);
                let b = parseInt(wallColorRGB[2]);
                console.log(wallColorRGB);
                console.log(r);
                console.log(g);
                console.log(b);
                let colorRGB = r + ', ' + g + ', ' + b;
                console.log(colorRGB + " running");
                document.getElementById('blur').style = 'content: ""; min-height: 100%; width: 100%; -webkit-backdrop-filter: blur(' + blurRadius + 'px) contrast(0.9); background-color: rgba(' + colorRGB + ', ' + blurOpacity + '); }';

            });
        }

        if (matchColor == true) {
            colorMatch();
        } else if (matchColor == false) {
            document.getElementById('blur').style = 'content: ""; min-height: 100%; width: 100%; -webkit-backdrop-filter: blur(' + blurRadius + 'px) contrast(0.9); background-color: rgba(' + blurRed + ', ' + blurGreen + ', ' + blurBlue + ', ' + blurOpacity + '); }';

        }


</script>
</body>
</html>